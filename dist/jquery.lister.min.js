/*
 *  Lister.js - v0.5.0
 *  A jQuery plugin to make lists from selects.
 *  http://jsumnersmith.github.io/lister
 *
 *  Made by Joel Smith
 *  Under MIT License
 */
!function(a){function b(b,d){var e=this;e.element=b,e.$element=a(e.element),e.settings=a.extend({},defaults,d),e._defaults=defaults,e._name=c,e.init()}var c="lister";defaults={listClass:"lister",openListClass:"lister-open",selectedClass:"lister-selected",selectedTop:!0,selectedTopText:!0,selectedTopWrapperClass:"lister-selected-top",populateSelectedTop:!0,listClickCallback:function(){},selectedTopOpenCallback:function(){},selectedTopCloseCallback:function(){}},b.prototype={init:function(){var a=this;a.cloneSelect(),a.listItemClick(),a.selectItemClick(),a.settings.selectedTop&&(a.createSelectedTop(),a.selectedTopClick())},cloneSelect:function(){var b=this;this.$element.each(function(){var c=a(this),d=c.clone().wrap("<div></div>").parent().html().replace(/select/g,"ul").replace(/option/g,"li"),e=a(d);e.addClass(b.settings.listClass),c.after(e),b.settings.selectedTop})},listItemClick:function(){var b=this,c=a("ul."+b.settings.listClass),d=c.find("li");d.click(function(c){var e=a(this),f=e.parent().prev(b.$element);c.stopPropagation(),d.removeClass(b.settings.selectedClass),e.addClass(b.settings.selectedClass),e.parent().hasClass(b.settings.openListClass)&&e.parent().removeClass(b.settings.openListClass);var g=f.find("option").eq(e.index());if(g.prop("selected",!0),b.settings.selectedTop){var h=a(f.prev("."+b.settings.selectedTopWrapperClass));h.text(g.text())}b.settings.listClickCallback&&b.settings.listClickCallback()})},selectItemClick:function(){{var b=this,c=b.$element;c.find("option")}b.$element.on("change",function(){var c=a(this);console.log(c);var d=c.val(),e=c.find("option"),f=c.next("ul."+b.settings.listClass),g=f.find("li"),h=c.prev("."+b.settings.selectedTopWrapperClass);e.each(function(){var c=a(this);if(c.val()===d){var e=f.find("li").eq(c.index());g.removeClass(b.settings.selectedClass),e.addClass(b.settings.selectedClass),h.text(c.text())}})})},createSelectedTop:function(){var b=this;b.$element.before("<div class='"+b.settings.selectedTopWrapperClass+"'></div>");{var c=a(b.$element.prev("."+b.settings.selectedTopWrapperClass)),d=c.next("select");d.next("ul")}if(b.settings.populateSelectedTop){var e=d.children("option").first();c.text(e.text())}},selectedTopClick:function(){var b=this,c=a(b.$element.prev("."+b.settings.selectedTopWrapperClass)),d=c.next("select"),e=d.next("ul");c.click(function(a){a.stopPropagation(),e.hasClass(b.settings.openListClass)?(e.removeClass(b.settings.openListClass),b.settings.selectedTopCloseCallback(b)):(e.addClass(b.settings.openListClass),b.settings.selectedTopOpenCallback(b))})},elsewhereClick:function(){var b=this,c=a("html"),d=a("ul."+b.settings.listClass);c.click(function(){return d.hasClass(b.settings.openListClass)?(d.removeClass(b.settings.openListClass),void b.settings.selectedTopCloseCallback(b)):null})}},a.fn.lister=function(d){return this.each(function(){a.data(this,"plugin_"+c)||a.data(this,"plugin_"+c,new b(this,d))})}}(jQuery,window,document);