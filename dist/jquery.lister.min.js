/*
 *  Lister.js - v0.5.0
 *  A jQuery plugin to make lists from selects.
 *  http://jsumnersmith.github.io/lister
 *
 *  Made by Joel Smith
 *  Under MIT License
 */
!function(a,b,c,d){function e(b,c){var d=this;d.element=b,d.$element=a(d.element),d.settings=a.extend({},defaults,c),d._defaults=defaults,d._name=f,d.init()}var f="lister";defaults={listClass:"lister",openListClass:"lister-open",selectedClass:"lister-selected",selectedTop:!0,selectedTopText:!0,selectedTopWrapperClass:"lister-selected-top",populateSelectedTop:!0,listClickCallback:function(){},selectedTopOpenCallback:function(){},selectedTopCloseCallback:function(){}},e.prototype={init:function(){var a=this;a.cloneSelect(),a.selectItemClick(),a.elsewhereClick(),a.settings.selectedTop&&(a.createSelectedTop(),a.selectedTopClick())},cloneSelect:function(){var b=this;b.$element.each(function(){var c=a(this),d=c.clone().wrap("<div></div>").parent().html().replace(/select/g,"ul").replace(/option/g,"li"),e=a(d);e.addClass(b.settings.listClass),c.after(e),b.settings.selectedTop}),b.listItemClick()},listItemClick:function(){var b=this,c=b.$element.siblings("ul."+b.settings.listClass),d=c.find("li");d.click(function(c){var e=a(this),f=e.parent().prev(b.$element);c.stopPropagation(),d.removeClass(b.settings.selectedClass),e.addClass(b.settings.selectedClass),e.parent().hasClass(b.settings.openListClass)&&e.parent().removeClass(b.settings.openListClass);var g=f.find("option").eq(e.index());if(g.prop("selected",!0),b.$element.trigger("change"),b.settings.selectedTop){var h=a(f.prev("."+b.settings.selectedTopWrapperClass));h.text(g.text())}b.settings.listClickCallback&&b.settings.listClickCallback()})},selectItemClick:function(){{var b=this,c=b.$element;c.find("option")}b.$element.on("change",function(){var c=a(this),d=c.val(),e=c.find("option"),f=c.next("ul."+b.settings.listClass),g=f.find("li"),h=c.prev("."+b.settings.selectedTopWrapperClass);e.each(function(){var c=a(this);if(c.val()===d){var e=f.find("li").eq(c.index());g.removeClass(b.settings.selectedClass),e.addClass(b.settings.selectedClass),h.text(c.text())}})})},createSelectedTop:function(){var b=this;b.$element.before("<div class='"+b.settings.selectedTopWrapperClass+"'></div>");{var c=a(b.$element.prev("."+b.settings.selectedTopWrapperClass)),e=c.next("select");e.next("ul")}if(b.settings.populateSelectedTop){var f=b.$element.val(),g=b.$element.find('option[value="'+f+'"]');f===d&&(g=b.$element.children("option").first()),c.text(g.text())}},selectedTopClick:function(){var b=this,c=a(b.$element.prev("."+b.settings.selectedTopWrapperClass)),d=c.next("select"),e=d.next("ul");c.click(function(a){a.stopPropagation(),e.hasClass(b.settings.openListClass)?(e.removeClass(b.settings.openListClass),b.settings.selectedTopCloseCallback(b)):(e.addClass(b.settings.openListClass),b.settings.selectedTopOpenCallback(b))})},elsewhereClick:function(){var b=this,c=a("html"),d=b.$element.siblings("ul."+b.settings.listClass);c.click(function(){return d.hasClass(b.settings.openListClass)?(d.removeClass(b.settings.openListClass),b.settings.selectedTopCloseCallback(b),void 0):null})}},a.fn.lister=function(b){return this.each(function(){a.data(this,"plugin_"+f)||a.data(this,"plugin_"+f,new e(this,b))})}}(jQuery,window,document);